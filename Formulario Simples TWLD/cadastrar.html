<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastrar Produtos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        "veneno-green": "#1a3a1a",
                    }
                }
            }
        }

        let produtos = [];
        
        function salvar() {
            let nome = document.getElementById("nome").value.trim()
            let precoInput = document.getElementById("preco").value.trim()
            let descricao = document.getElementById("descricao").value.trim()

            // Validação do nome
            if (nome == "" || nome.length < 3) {
                document.getElementById("erro-nome").classList.remove("hidden")
                return false
            }

            // Validação do preço
            if (precoInput === "" || !/^[0-9]+([,\.][0-9]{1,2})?$/.test(precoInput)) {
                document.getElementById("erro-preco").textContent = "Insira um valor numérico válido (ex: 14,99)"
                document.getElementById("erro-preco").classList.remove("hidden")
                return false
            }

            // Converte para número (aceitando tanto . quanto , como separador decimal)
            let preco = parseFloat(precoInput.replace(',', '.'))
            
            if (preco <= 0) {
                document.getElementById("erro-preco").textContent = "O preço deve ser maior que zero"
                document.getElementById("erro-preco").classList.remove("hidden")
                return false
            }

            // Formata para 2 casas decimais
            let precoFormatado = preco.toFixed(2)

            let novoProduto = {
                "nome": nome,
                "preco": precoFormatado,
                "descricao": descricao
            }

            produtos.push(novoProduto)
            console.log(produtos)

            document.getElementById("mensagem").classList.remove("hidden")
            setTimeout(function(){
                document.getElementById("mensagem").classList.add("hidden")
            }, 1000)
            limparForm()
            carregarProdutos()
            return false
        }

        function carregarProdutos() {
            let tbody = document.querySelector("tbody")
            tbody.innerHTML = "";

            produtos.forEach(produto => {
                let linha = document.createElement("tr")
                linha.className = "hover:bg-gray-100 border-b border-gray-200"
                linha.innerHTML = `
                    <td class="px-6 py-4 font-medium text-gray-900">${produto.nome}</td>
                    <td class="px-6 py-4">R$ ${produto.preco}</td>
                    <td class="px-6 py-4 text-gray-700">${produto.descricao}</td>
                    <td class="px-6 py-4">
                        <button class="bg-veneno-green hover:bg-green-800 text-white px-4 py-2 rounded mr-2 border border-black">Alterar</button>
                        <button class="bg-red-600 hover:bg-red-800 text-white px-4 py-2 rounded border border-black">Excluir</button>
                    </td>
                `;
                tbody.appendChild(linha)
            })
        }

        function limparForm() {
            document.getElementById("nome").value = ""
            document.getElementById("preco").value = ""
            document.getElementById("descricao").value = ""
            document.getElementById("nome").focus()
        }

        function limparErro(id) {
            document.getElementById(id).classList.add("hidden")
        }
    </script>
</head>
<body class="bg-white">
    <div class="container mx-auto p-6 max-w-6xl">
        <a href="index.html" class="inline-block mb-8 text-veneno-green hover:text-green-800 font-bold">
            ← Voltar à Página Inicial
        </a>

        <h1 class="text-3xl font-bold mb-8 text-black border-b-2 border-veneno-green pb-2">
            Cadastro de Produtos
        </h1>

        <!-- Tabela -->
        <div class="mb-12 overflow-x-auto rounded-lg border-2 border-black shadow-lg">
            <table class="w-full">
                <thead class="bg-veneno-green text-white">
                    <tr>
                        <th class="px-6 py-4 text-left font-bold">Nome</th>
                        <th class="px-6 py-4 text-left font-bold">Preço</th>
                        <th class="px-6 py-4 text-left font-bold">Descrição</th>
                        <th class="px-6 py-4 text-left font-bold">Ações</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Formulário -->
        <form id="form-cadastro" onsubmit="return salvar()" class="bg-white p-8 rounded-lg border-2 border-black shadow-lg">
            <div class="mb-6">
                <label for="nome" class="block text-black mb-2 font-bold">Nome do Produto</label>
                <input type="text" id="nome" class="w-full px-4 py-3 border-2 border-black rounded-lg focus:ring-2 focus:ring-veneno-green focus:outline-none">
                <div id="erro-nome" class="hidden text-red-600 mt-2 font-medium">Preencha o nome do produto</div>
            </div>

            <div class="mb-6">
                <label for="preco" class="block text-black mb-2 font-bold">Preço</label>
                <input 
                    type="text" 
                    id="preco" 
                    class="w-full px-4 py-3 border-2 border-black rounded-lg focus:ring-2 focus:ring-veneno-green focus:outline-none"
                    oninput="this.value = this.value.replace(/[^0-9,.]/g, '').replace(/(\..*)\./g, '$1')"
                >
                <div id="erro-preco" class="hidden text-red-600 mt-2 font-medium">Insira um valor numérico válido</div>
            </div>

            <div class="mb-8">
                <label for="descricao" class="block text-black mb-2 font-bold">Descrição (opcional)</label>
                <textarea id="descricao" rows="4" class="w-full px-4 py-3 border-2 border-black rounded-lg focus:ring-2 focus:ring-veneno-green focus:outline-none"></textarea>
            </div>

            <button type="submit" class="w-full bg-veneno-green hover:bg-green-800 text-white font-bold py-3 px-4 rounded-lg border-2 border-black shadow-md transition-colors">
                Salvar Produto
            </button>
        </form>

        <!-- Mensagem de Sucesso -->
        <div id="mensagem" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
            <div class="bg-white p-8 rounded-lg border-2 border-veneno-green shadow-xl text-center max-w-md">
                <p class="text-2xl font-bold text-veneno-green mb-4">✓</p>
                <p class="text-xl font-bold text-black">Produto cadastrado com sucesso!</p>
            </div>
        </div>
    </div>
</body>
</html>